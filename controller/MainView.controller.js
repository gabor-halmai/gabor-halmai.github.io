sap.ui.define(["com/otisoft/favs/Favorites/controller/BaseController","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,i){"use strict";return e.extend("com.otisoft.favs.Favorites.controller.MainView",{onInit:function(){this.loadThemeFromStorage()},onPress:function(e){sap.m.URLHelper.redirect(e,true)},onSearch:function(e){this.applySearchFilter()},onSearchLiveChange:function(e){this.applySearchFilter()},applySearchFilter:function(){let e=this.getView().byId("idGroupsList");let i=e.getBinding("items");let r=this.getView().byId("idSearchField");let o=r.getValue().toLowerCase();if(!o){i.filter([]);this._clearChildFilters();return}let n=new t({test:e=>e.header&&e.header.toLowerCase().includes(o)||e.subheader&&e.subheader.toLowerCase().includes(o)});let s=new t({test:e=>e.header&&e.header.toLowerCase().includes(o)||e.subheader&&e.subheader.toLowerCase().includes(o)});let a=e=>{if(e.tiles){for(let t of e.tiles){if(t.header&&t.header.toLowerCase().includes(o)||t.subheader&&t.subheader.toLowerCase().includes(o)){return true}}}if(e.links){for(let t of e.links){if(t.header&&t.header.toLowerCase().includes(o)||t.subheader&&t.subheader.toLowerCase().includes(o)){return true}}}return false};let l=new t({test:a});i.filter([l]);this._applyChildFilters(n,s)},_applyChildFilters:function(e,t){let i=this.getView().byId("idGroupsList");let r=i.getItems();r.forEach(i=>{let r=i.getContent()[0];if(!r||!r.getContent)return;let o=r.getContent()[0];if(!o||!o.getContent)return;let n=o.getContent();if(n[0]&&n[0].getBinding){let t=n[0].getBinding("content");if(t){t.filter([e])}}if(n[1]&&n[1].getBinding){let e=n[1].getBinding("content");if(e){e.filter([t])}}})},_clearChildFilters:function(){let e=this.getView().byId("idGroupsList");let t=e.getItems();t.forEach(e=>{let t=e.getContent()[0];if(!t||!t.getContent)return;let i=t.getContent()[0];if(!i||!i.getContent)return;let r=i.getContent();r.forEach(e=>{if(e.getBinding){let t=e.getBinding("content");if(t){t.filter([])}}})})},onPanelExpand:function(e){let t=e.getParameter("expand");if(t){let t=e.getSource().data().groupId;if(t){this.collapseGroupsExcept(t)}}},collapseGroupsExcept:function(e){let t=this.getOwnerComponent().getModel("favorites");let i=t.getProperty("/groups");for(let t of i){if(t.title!==e){t.expanded=false}}},onThemeToggle:function(e){let t=e.getParameter("state");let i=t?"sap_horizon":"sap_horizon_dark";this.applyTheme(i);this.saveThemeToStorage(i)},applyTheme:function(e){sap.ui.getCore().applyTheme(e);let t=this.getView().byId("idApp");if(e==="sap_horizon"){t.setBackgroundImage("resources/img/bgLight.jpg")}else if(e==="sap_horizon_dark"){t.setBackgroundImage("resources/img/bg.jpg")}},saveThemeToStorage:function(e){localStorage.setItem("com.sapdev.eu.favorites.theme",e)},loadThemeFromStorage:function(){let e=localStorage.getItem("com.sapdev.eu.favorites.theme");let t=this.getView().byId("idThemeSwitch");if(e){this.applyTheme(e);if(e==="sap_horizon"){t.setState(true)}else{t.setState(false)}}else{t.setState(false)}}})});
//# sourceMappingURL=MainView.controller.js.map